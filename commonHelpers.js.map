{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst myApiKey = '43199917-ac2cc136e7963c28457226ad3';\naxios.defaults.baseURL = 'https://pixabay.com/api/';\n\nasync function fetchImages(valueForSearch, page) {\n  const params = {\n    key: myApiKey,\n    q: valueForSearch.trim(),\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    per_page: 15,\n    page: page.currentPage,\n  };\n\n  const response = await axios.get(``, { params });\n\n  page.currentPage += 1;\n  return response.data;\n}\n\nexport default fetchImages;\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nfunction renderImages(images) {\n  try {\n    if (!images.length) {\n      throw Error(`There are no images matching the search query`);\n    }\n  } catch (error) {\n    iziToast.error({\n      message:\n        'Sorry, there are no images matching your search query. Please try again!',\n      position: 'topRight',\n    });\n    console.log(error);\n  }\n  const markupImages = images\n    .map(image => {\n      return `\n            <li class=\"item\">\n            <a href=\"${image.largeImageURL}\">\n            <img src=\"${image.webformatURL}\" alt=\"${image.tags}\">\n            </a>\n            <div class=\"item-content\">\n            <div>\n            <h3 class=\"title\">Likes</h3>\n            <p class=\"amount\">${image.likes}</p>\n            </div>\n            <div>\n            <h3 class=\"title\">Views</h3>\n            <p class=\"amount\">${image.views}</p>\n            </div>\n            <div>\n            <h3 class=\"title\">Comments</h3>\n            <p class=\"amount\">${image.comments}</p>\n            </div>\n            <div>\n            <h3 class=\"title\">Downloads</h3>\n            <p class=\"amount\">${image.downloads}</p>\n            </div>\n            </div>\n            </li>\n            `;\n    })\n    .join('');\n  return markupImages;\n}\n\nexport default renderImages;\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport fetchImages from './js/pixabay-api';\nimport renderImages from './js/render-functions';\n\nconst form = document.querySelector('.form');\nconst searchInput = form.elements.input;\nconst imagesList = document.querySelector('.container');\nconst loadingMessage = document.querySelector('.loader');\nconst loadMoreButton = document.querySelector(`.next-page-btn`);\nconst endMessage = document.querySelector(`.end`);\n\nform.addEventListener('submit', searchImages);\nloadMoreButton.addEventListener(`click`, loadMore);\n\nlet valueForSearch = ``;\n\nconst page = { currentPage: 1 };\nlet totalPages = 0;\n\nfunction searchImages(event) {\n  event.preventDefault();\n  endMessage.classList.add(`is-hidden`);\n\n  valueForSearch = searchInput.value;\n  page.currentPage = 1;\n  imagesList.innerHTML = '';\n\n  if (!searchInput.value.trim()) {\n    makeErrorMessage('Your query does not contain any letters!');\n    return;\n  }\n  loadingMessage.classList.remove('is-hidden');\n\n  fetchImages(valueForSearch, page)\n    .then(response => {\n      loadingMessage.classList.add(`is-hidden`);\n      totalPages = Math.ceil(response.totalHits / 15);\n      if (page.currentPage <= totalPages) {\n        loadMoreButton.classList.remove(`is-hidden`);\n      }\n      if (!response.hits) {\n        makeErrorMessage('There is a problem with on the server');\n        throw new Error(`Object \"hits\" is missing`);\n      }\n      imagesList.insertAdjacentHTML(`beforeend`, renderImages(response.hits));\n      lightbox.refresh();\n    })\n    .catch(error => {\n      loadingMessage.classList.add(`is-hidden`);\n      console.log(error);\n    })\n    .finally(() => form.reset());\n}\n\nfunction loadMore() {\n  loadMoreButton.classList.remove(`is-hidden`);\n  fetchImages(valueForSearch, page)\n    .then(response => {\n      loadingMessage.classList.add(`is-hidden`);\n      totalPages = Math.ceil(response.totalHits / 15);\n      if (page.currentPage > totalPages) {\n        loadMoreButton.classList.add(`is-hidden`);\n        endMessage.classList.remove(`is-hidden`);\n      }\n      if (!response.hits) {\n        makeErrorMessage('There is a problem with data on the server');\n        throw new Error(`Object \"hits\" is missing`);\n      }\n      imagesList.insertAdjacentHTML(`beforeend`, renderImages(response.hits));\n      lightbox.refresh();\n      makeScroll();\n    })\n    .catch(error => {\n      loadingMessage.classList.add(`is-hidden`);\n      console.log(error);\n    });\n}\nconst lightbox = new SimpleLightbox('.container a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nfunction makeScroll() {\n  const card = imagesList.firstElementChild;\n  const height = card.getBoundingClientRect().height;\n  window.scrollBy({\n    top: height * 2,\n    behavior: 'smooth',\n  });\n}\n\nfunction makeErrorMessage(message) {\n  iziToast.error({\n    message,\n    position: 'topRight',\n  });\n}\n"],"names":["myApiKey","axios","fetchImages","valueForSearch","page","params","response","renderImages","images","error","iziToast","image","form","searchInput","imagesList","loadingMessage","loadMoreButton","endMessage","searchImages","loadMore","totalPages","event","makeErrorMessage","lightbox","makeScroll","SimpleLightbox","height","message"],"mappings":"owBAEA,MAAMA,EAAW,qCACjBC,EAAM,SAAS,QAAU,2BAEzB,eAAeC,EAAYC,EAAgBC,EAAM,CAC/C,MAAMC,EAAS,CACb,IAAKL,EACL,EAAGG,EAAe,KAAM,EACxB,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAU,GACV,KAAMC,EAAK,WACf,EAEQE,EAAW,MAAML,EAAM,IAAI,GAAI,CAAE,OAAAI,CAAM,CAAE,EAE/C,OAAAD,EAAK,aAAe,EACbE,EAAS,IAClB,CCjBA,SAASC,EAAaC,EAAQ,CAC5B,GAAI,CACF,GAAI,CAACA,EAAO,OACV,MAAM,MAAM,+CAA+C,CAE9D,OAAQC,EAAO,CACdC,EAAS,MAAM,CACb,QACE,2EACF,SAAU,UAChB,CAAK,EACD,QAAQ,IAAID,CAAK,CAClB,CA8BD,OA7BqBD,EAClB,IAAIG,GACI;AAAA;AAAA,uBAEUA,EAAM,aAAa;AAAA,wBAClBA,EAAM,YAAY,UAAUA,EAAM,IAAI;AAAA;AAAA;AAAA;AAAA;AAAA,gCAK9BA,EAAM,KAAK;AAAA;AAAA;AAAA;AAAA,gCAIXA,EAAM,KAAK;AAAA;AAAA;AAAA;AAAA,gCAIXA,EAAM,QAAQ;AAAA;AAAA;AAAA;AAAA,gCAIdA,EAAM,SAAS;AAAA;AAAA;AAAA;AAAA,aAK1C,EACA,KAAK,EAAE,CAEZ,CCrCA,MAAMC,EAAO,SAAS,cAAc,OAAO,EACrCC,EAAcD,EAAK,SAAS,MAC5BE,EAAa,SAAS,cAAc,YAAY,EAChDC,EAAiB,SAAS,cAAc,SAAS,EACjDC,EAAiB,SAAS,cAAc,gBAAgB,EACxDC,EAAa,SAAS,cAAc,MAAM,EAEhDL,EAAK,iBAAiB,SAAUM,CAAY,EAC5CF,EAAe,iBAAiB,QAASG,CAAQ,EAEjD,IAAIhB,EAAiB,GAErB,MAAMC,EAAO,CAAE,YAAa,GAC5B,IAAIgB,EAAa,EAEjB,SAASF,EAAaG,EAAO,CAQ3B,GAPAA,EAAM,eAAc,EACpBJ,EAAW,UAAU,IAAI,WAAW,EAEpCd,EAAiBU,EAAY,MAC7BT,EAAK,YAAc,EACnBU,EAAW,UAAY,GAEnB,CAACD,EAAY,MAAM,OAAQ,CAC7BS,EAAiB,0CAA0C,EAC3D,MACD,CACDP,EAAe,UAAU,OAAO,WAAW,EAE3Cb,EAAYC,EAAgBC,CAAI,EAC7B,KAAKE,GAAY,CAMhB,GALAS,EAAe,UAAU,IAAI,WAAW,EACxCK,EAAa,KAAK,KAAKd,EAAS,UAAY,EAAE,EAC1CF,EAAK,aAAegB,GACtBJ,EAAe,UAAU,OAAO,WAAW,EAEzC,CAACV,EAAS,KACZ,MAAAgB,EAAiB,uCAAuC,EAClD,IAAI,MAAM,0BAA0B,EAE5CR,EAAW,mBAAmB,YAAaP,EAAaD,EAAS,IAAI,CAAC,EACtEiB,EAAS,QAAO,CACtB,CAAK,EACA,MAAMd,GAAS,CACdM,EAAe,UAAU,IAAI,WAAW,EACxC,QAAQ,IAAIN,CAAK,CACvB,CAAK,EACA,QAAQ,IAAMG,EAAK,MAAK,CAAE,CAC/B,CAEA,SAASO,GAAW,CAClBH,EAAe,UAAU,OAAO,WAAW,EAC3Cd,EAAYC,EAAgBC,CAAI,EAC7B,KAAKE,GAAY,CAOhB,GANAS,EAAe,UAAU,IAAI,WAAW,EACxCK,EAAa,KAAK,KAAKd,EAAS,UAAY,EAAE,EAC1CF,EAAK,YAAcgB,IACrBJ,EAAe,UAAU,IAAI,WAAW,EACxCC,EAAW,UAAU,OAAO,WAAW,GAErC,CAACX,EAAS,KACZ,MAAAgB,EAAiB,4CAA4C,EACvD,IAAI,MAAM,0BAA0B,EAE5CR,EAAW,mBAAmB,YAAaP,EAAaD,EAAS,IAAI,CAAC,EACtEiB,EAAS,QAAO,EAChBC,GACN,CAAK,EACA,MAAMf,GAAS,CACdM,EAAe,UAAU,IAAI,WAAW,EACxC,QAAQ,IAAIN,CAAK,CACvB,CAAK,CACL,CACA,MAAMc,EAAW,IAAIE,EAAe,eAAgB,CAClD,aAAc,MACd,aAAc,GAChB,CAAC,EAED,SAASD,GAAa,CAEpB,MAAME,EADOZ,EAAW,kBACJ,sBAAqB,EAAG,OAC5C,OAAO,SAAS,CACd,IAAKY,EAAS,EACd,SAAU,QACd,CAAG,CACH,CAEA,SAASJ,EAAiBK,EAAS,CACjCjB,EAAS,MAAM,CACb,QAAAiB,EACA,SAAU,UACd,CAAG,CACH"}